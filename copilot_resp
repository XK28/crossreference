import asyncio
from playwright.async_api import async_playwright

async def main():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        context = await browser.new_context()
        page = await context.new_page()

        # 1. Ir a la página de login
        await page.goto("https://web-prod.core.appst.bancolombia.corp/CWC/services/cobis/web/bank/views/commons/login.html")

        # 2. Hacer clic en el botón "Microsoft"
        await page.wait_for_selector('text=Microsoft')
        await page.click('text=Microsoft')

        # 3. Ingresar usuario
        await page.wait_for_selector('input[type="email"]', timeout=60000)
        await page.fill('input[type="email"]', 'tu_usuario@bancolombia.com.co')
        await page.press('input[type="email"]', 'Enter')

        # 4. Ingresar contraseña
        await page.wait_for_selector('input[type="password"]', timeout=60000)
        await page.fill('input[type="password"]', 'tu_contraseña_segura')
        await page.press('input[type="password"]', 'Enter')

        # 5. Esperar redirección y carga de dropdowns
        await page.wait_for_load_state('networkidle')
        await page.wait_for_selector('select', timeout=60000)

        # 6. Seleccionar opciones en los dropdowns
        dropdowns = await page.query_selector_all('select')
        for dropdown in dropdowns:
            await dropdown.select_option(index=1)  # Selecciona la segunda opción

        # 7. Hacer clic en "Ingresar"
        await page.click('text=Ingresar')

        await page.wait_for_timeout(5000)
        await browser.close()

asyncio.run(main())
